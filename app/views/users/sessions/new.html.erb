<h3><%= t(".title") %></h3>

<div class="flash" id="login_result">
  <span class="flash_alert"><%= t(".login_failed") %></span>
  Login failed. Try again.
</div>

<%= form_for(resource, :as => resource_name, :url => session_path(resource_name,:json), :remote => true) do |f| %>
  <p><%= f.label :nickname %><br />
  <%= f.text_field :nickname %></p>

  <p><%= f.label :password %><br />
  <%= f.password_field :password %></p>

  <% if devise_mapping.rememberable? -%>
    <p><%= f.check_box :remember_me %> <%= f.label :remember_me %></p>
  <% end -%>

  <p><%= f.submit "Sign in" %></p>
<% end %>

<%= javascript_tag do %>
  $('user_new').on('ajax:success', function(request) {
    result = request.json;
    if(result.success == true) {
      window.location.href = result.redirect;
    } else {
      show_for_a_while($('login_result'), 4000);
    }
  });
<% end %>

<%= render :partial => "devise/shared/links" %>
